import { describe, expect, it } from 'vitest'

import { expWad } from './expWad'

describe('expWad', () => {
  /**
   * This tests our `expWad` output to be equal to solady's FixedPointMathLib implementation.
   * @see https://github.com/Vectorized/solady/blob/9deb9ed36a27261a8745db5b7cd7f4cdc3b1cd4e/test/FixedPointMathLib.t.sol#L8
   */
  it('should calculate expWad correctly', () => {
    expect(expWad(-42139678854452767551n)).toBe(0n) // 0n

    expect(expWad(BigInt(-3e18))).toBe(49787068367863942n) // 49787068367863942n
    expect(expWad(BigInt(-2e18))).toBe(135335283236612691n) // 135335283236612691n
    expect(expWad(BigInt(-1e18))).toBe(367879441171442321n) // 367879441171442321n

    expect(expWad(BigInt(-0.5e18))).toBe(606530659712633423n) // 606530659712633423n
    expect(expWad(BigInt(-0.3e18))).toBe(740818220681717866n) // 740818220681717866n

    expect(expWad(BigInt(0))).toBe(1000000000000000000n)

    expect(expWad(BigInt(0.3e18))).toBe(1349858807576003103n) // 1349858807576003103n
    expect(expWad(BigInt(0.5e18))).toBe(1648721270700128146n) // 1648721270700128146n

    expect(expWad(BigInt(1e18))).toBe(2718281828459045235n) // 2718281828459045235n
    expect(expWad(BigInt(2e18))).toBe(7389056098930650227n) // 7389056098930650227n
    expect(expWad(BigInt(3e18))).toBe(20085536923187667741n) // 20085536923187667741n

    expect(expWad(BigInt(10e18))).toBe(22026465794806716516980n) // 22026465794806716516980n

    expect(expWad(BigInt(50e18))).toBe(5184705528587072464148529318587763226117n) // 5184705528587072464148529318587763226117n

    expect(expWad(BigInt(100e18))).toBe(26881171418161354484134666106240937146178367581647816351662017n) // 26881171418161354484134666106240937146178367581647816351662017n

    expect(expWad(BigInt(135305999368893231588n))).toBe(
      57896044618658097650144101621524338577433870140581303254786265309376407432913n,
    ) // 57896044618658097650144101621524338577433870140581303254786265309376407432913n
  })
})
